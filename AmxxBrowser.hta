<!-- AMXX Browser V1.0 -->
<!-- 2020-05-23 By Schmurtz -->
<html>
    <head>
		<meta charset="utf-8">
		<meta http-equiv="x-ua-compatible" content="IE=10">
		<meta http-equiv="content-type" content="text/html">
		<meta name="viewport" content="width=device-width, initial-scale=1">  

		<title>Amxx Browser</title>

		<!--  ========================================== jquery ========================================== -->
			<!--  <script src='https://bootswatch.com/_vendor/jquery/dist/jquery.min.js'></script>    v3.4.1-->
			<!--  <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js'> </script>  -->
			<!--  <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js'>  </script>  -->
			<!--  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
			<!-- <script src="https://code.jquery.com/jquery-3.5.1.js"></script> -->
			<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">  </script> -->
			
			<script src="dependencies/jquery/jquery-3.5.1.min.js"></script>  <!-- = https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js -->

		<!--  ======================================= bootstrapcdn ======================================= -->
		<!--	Choose your CSS skin here  :https://www.bootstrapcdn.com/legacy/bootswatch/  -->
			
			<!-- <link rel='stylesheet' href='https://bootswatch.com/3/darkly/bootstrap.min.css'> -->
			<!--  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.4.1/darkly/bootstrap.min.css"> -->
			<!--  <link rel="stylesheet" href="https://bootswatch.com/4/darkly/bootstrap.css"> -->

			<!-- 
			<script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js'></script>    
				<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/3.4.1/slate/bootstrap.min.css"> -->
			
			<link rel="stylesheet" href="dependencies/Bootstrap/bootstrap.css">
			<script src='dependencies/Bootstrap/bootstrap.min.js'></script>    

		<!--  ======================================== Table Filter ======================================== -->

			<!-- ************* jQuery.FilterTable : more powerful filter ************* -->
			<!--  <script type="text/javascript" src='dependencies\jQuery.FilterTable\jquery.filtertable.js'></script>   -->

			<!-- ************* Even  more powerful filter ! : datatables.net ************* -->

			<!-- Working fine but not perfect CSS with bootstrapcdn
			<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/jqc-1.12.4/datatables.min.css"/>
			<script type="text/javascript" src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
			

			-->
			
			<!-- OK with boostrap 3 too : https://cdn.datatables.net/1.10.21/css/dataTables.bootstrap.min.css  --> 
			
			<!--  This one is OK  : we use this one copied locally  
			<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs/dt-1.10.21/b-1.6.2/b-colvis-1.6.2/b-html5-1.6.2/b-print-1.6.2/kt-2.5.2/sc-2.0.2/sp-1.1.0/datatables.min.css"/>
			<script type="text/javascript" src="https://cdn.datatables.net/v/bs/dt-1.10.21/b-1.6.2/b-colvis-1.6.2/b-html5-1.6.2/b-print-1.6.2/kt-2.5.2/sc-2.0.2/sp-1.1.0/datatables.min.js"></script> 
			-->
			
			<link rel="stylesheet" type="text/css" href="dependencies/datatables/datatables.min.css"/>
			<script type="text/javascript" src="dependencies/datatables/datatables.min.js"></script>
			<link rel="stylesheet" type="text/css" href="dependencies/datatables/buttons.dataTables.css"/>  <!-- to aligne buttons on the top of the table -->

			

		<!--  ==================================== GIF animated library ==================================== -->

			<!--  https://raw.githubusercontent.com/krasimir/gifffer/master/build/gifffer.min.js   -->
			<script type="text/javascript" src="dependencies/gifffer.min.js"></script>

			
		<!--  ==================================== Video player library ==================================== -->
		<!--  ==================================== video js : alternative to the default video player ==================================== -->
			
			<!--  we use this one locally :
			<link href="https://vjs.zencdn.net/7.8.1/video-js.css" rel="stylesheet" />
			<script src="https://vjs.zencdn.net/7.8.1/video.js"></script>
			-->
			
			<link href="dependencies/video-js/video-js-7.8.1.css" rel="stylesheet" />
			<script src="dependencies/video-js/video-js-7.8.1.js"></script>
			
			

			<!-- If you'd like to support IE8 (for Video.js versions prior to v7)
			<script src="https://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script> 

		<!--  *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*= CSS Management *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*= -->
					

		<!-- remove bugged IE clear cross in filter input -->
		<!-- 	<style>::-ms-clear { display: none; } </style>    -->
		
		<!--  *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*= -->
		 <!-- Color for the table cell when filter is active  (declaration for  jQuery.FilterTable)  -->
		<!-- 
		<style> 
		.filter-table .quick { margin-left: 0.5em; font-size: 0.8em; text-decoration: none; }
		.fitler-table .quick:hover { text-decoration: underline; }
		td.alt { background-color: #ffc; background-color: rgba(0, 255, 0, 0.2); }
		</style>
		-->
		
		<!--  *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*= -->
		
		<!--     If you want to keep table header on top, uncomment this CSS section-->
		<!-- 

		table {    width: 100%;}
		thead, tbody, tr, td, th { display: block; }
		tr:after { content: ' '; display: block;  visibility: hidden;  clear: both; }
		thead th { height: 30px; /*text-align: left;*/ }
		tbody { height: 520px; overflow-y: auto; }
		thead { /* fallback */}
		tbody td, thead th { width: 19.2%; float: left; }
		-->
		
		<!--  *=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*= -->
		<style> 
		 tfoot input {
				width: 100%;
				padding: 3px;
				box-sizing: border-box;
			}
		</style>
		
		<style> 
			/* Overrides list-group-item from Bootstrap 3, default values : 10px 15px (not necessary with bootstrap 4) */ 
			.list-group-item {
			padding: 4px 15px
			}	
		</style>	

		<style> 
		/* Overrides form-control from Bootstrap 3, default values : 10px 15px (not necessary with bootstrap 4) */ 
		.form-control {
		padding: 2px 15px
		}	
		</style>	

		<style> 
			/* Overrides btn from Bootstrap 3, default values : unknown (We could use btn-sm for small buttons but I didn't know how to put it in js "clear filters" button) */ 
			.btn {
			padding: 4px 10px
			}	
		</style>	





    </head>



<body>
<!--  <h3>Amxx Plugin brower</h3>  -->


<SCRIPT language="VBScript">
	' Global variables
	Dim CurPluginNumber
	Dim PreviousPreset
</SCRIPT>

<!--   ----------------------------------  Tabs ----------------------------------    -->
<br>
<ul class="nav nav-tabs"> <span style="font-size:30px; float: right; margin-right:800px; white-space: nowrap;" >Amxx Plugin brower</span>   <!--  Dirty way to put a title    -->
  <li class="active"><a href="#home" data-toggle="tab">Home</a></li>
  <li class="disabled"><a href="#settings" data-toggle="tab">Settings</a></li>
  <li class="disabled"><a href="#tools" data-toggle="tab">Tools</a></li>

  
  <li class="dropdown disabled">
    <a class="dropdown-toggle" data-toggle="dropdown" href="#">Servers<span class="caret"></span></a>
    <ul class="dropdown-menu">
      <li><a href="#dropdown1" data-toggle="tab">Config</a></li>
      <li class="divider"></li>
      <li><a href="#dropdown2" data-toggle="tab">Launcher</a></li>
    </ul>
  </li>
 
</ul>
<!--   ---------------------------------------------------------------------------    -->
<div id="myTabContent" class="tab-content">   <!--   ----- main tab menu container ----    -->
	<div class="tab-pane fade active in" id="home">  <!--   ----- 1st tab : home ----    -->
		<BR>
		<!-- <legend>Home</legend> -->
				<table id="PresetsTable" class="table table-bordered">
					<tr>
						<td>
							<div class="form-group form-group-sm">
								<!--smaller labels & dropdown -->
								<label for="select" class="col-lg-2 control-label">Presets</label>
								<div class="col-xs-2">
									<!-- set width of the dropdown -->
									<select class="form-control" id="SelectPreset" onfocus="SetPreviousPreset()" onchange="Load_Preset()">
										<script type="text/vbs">
											FillPresetsList(Null)
											Sub FillPresetsList(SelectedValue)
												Dim fso, folder, files ,item , ListCounter
												Dim PresetsPath
												Dim DropDown
												' Define folder we want to list files from
												PresetsPath = ".\presets"
												Set FSO = CreateObject("Scripting.FileSystemObject")
												If Not FSO.FolderExists(PresetsPath) Then FSO.CreateFolder(PresetsPath) ' We check if the folder exist...
												Set folder = fso.GetFolder(PresetsPath)
												Set files = folder.Files
												
													For Each objOption in SelectPreset.Options
														objOption.RemoveNode
													Next
													'document.write "<option></option>" ' we add an empty selection
													Set DropDown = document.createElement("option")
													Dropdown.Value = ""
													Dropdown.Text = ""
													SelectPreset.add DropDown
												' Loop through each file  
												For Each item In files
													'#Populate DropdownBox
													if right(item.Name,4) = ".ini" then       ' Filter : only .ini files
														if item.Name <> ".Template.ini" then  ' We don't include the template file which is the default plugins.ini from amxx, it include some defaults plugins
															ListCounter = ListCounter + 1
															Set DropDown = document.createElement("option")
															Dropdown.Value = item.Name
															Dropdown.Text = item.Name
															SelectPreset.add DropDown
															if SelectedValue = item.Name then SelectPreset.selectedindex = ListCounter
														end if
													end if
	
													'#Populate DropdownBox - alternative way
													'	document.write "<option>" & item.Name & "</option>" 
												Next
												
											End Sub
										</script>
				
									</select>
								</div>
				
				
								<div style="float:left;">
									<a href="#" onclick="OpenPreset()"><img border="0" alt="Open Preset"
										src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAB3RJTUUH5AUTDgwOit7LNAAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMC4zjOaXUAAAAPJJREFUOE+NkrkKwkAURUeLuHSKjVpY2IiFWFvY2CqIf2BlJ24YsXArxD+y9scSzxtmQoyZkAuHt8y9GQijREEQzOAOviUMw5PFnL3pyzpgxaLAwcOMqcLTwHOEp/jNWh94LA/SUyvMPQtzx3hq9Cvogy87LQ7KLLbSU+vMcwvz2HgK8DKeCSyl/wvDNMZImxC+IfMFzvBh9n7C9FX6QYyuTibEfiO55M1NWGfQdIbp5c+XZOeg6AxT5eZtBi1nOK9Sw9Q2c/Syksi5M5xX8XD0wvIK/05yEpbXczP7XCJ8lZwdFvIB6h7S/rJlb3wLpZT6AnNOzKjpvVs/AAAAAElFTkSuQmCC"></a>
									<span class="invisible" id="ModificationIndic"><strong><span style="color: #ff0000; font-size:larger;">*</span></strong></span>
									<a href="#" class="btn btn-default btn-sm" value="SavePreset" id="BtnPresetSave" onclick="Save_Preset('?',false)">Save</a>
									<a href="#" class="btn btn-default btn-sm" value="NewPreset" onclick="New_Preset()">Save as New</a>
									&nbsp;<input type="checkbox" id="Chk_IncDesc" checked>&nbsp;&nbsp;Add description in preset file
								</div>
							</div>
						</td>
						<!-- <td>
						 <label for="select" class="col-lg-2 control-label">Presets</label> 
							<div class="col-xs-3">
								<div class="form-group">
				
									<div class="col-lg-20">
										<input type="text" class="form-control input-sm" id="inputPresetName" placeholder="Preset Name"> 
									</div>
								</div>
							</div>
				
							<div style="float:left;"></div>
							</div>
						</td>-->
					</tr>
				</table>


<HR>




  <!--   --------------------------- some tests for later....
 <div class='pull-right'><span class="label label-success">aze</span></div>
<a href="#" data-toggle="tooltip" data-placement="left" title="Hooray!">Hover</a>
<a href="#" data-toggle="popover" title="Popover Header" data-content="Some content inside the popover">Toggle popover</a>
<ul class="list-group"> 
           <li class="list-group-item">Bootstrap <span class="badge">aze</span></li> 
           <li class="list-group-item">HTML5/CSS <div class="pull-right"><span class="label label-success">aze</span></div></li> 
           <li class="list-group-item">PHP/MYSQL <span class="badge">32</span></li> 
           <li class="list-group-item">JAVA/JEE <span class="badge">9</span></li>    
           <li class="list-group-item">BIGDATA/HADOOP <span class="badge">7</span></li>  
</ul>



 <img src="data:image/gif;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0CcguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7"width="16" height="14" alt="embedded folder icon">
  

<input type="IMAGE" <img alt="Test Button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAACASURBVDhPxZPRCYAwDES7goO4caE4g/P0o51Ec6T0KNWkIPjggVxy8UMMn1BKSbcneejIx1CGOvIxO/BkrTVqrTNbfFNrHRpuGq3Bl+mYZUJZaCE/e0RZ4IAXLFEWOOAFS5QFDnjBEmWhBTnnnRcstb72VlbrODD+Cx77Z/yREC7ODt7GVk9G6wAAAABJRU5ErkJggg==" 
align="middle" value = "Test Button" onclick="Load_Preset()"/> <Br><Br>

  <Br>&nbsp;&nbsp;&nbsp;
  <input type="IMAGE" <img alt="Test Button" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOcwAADnMBOWAVqQAAAAd0SU1FB+QFCwwuArLzaiEAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAAJpSURBVEhLrZaBceIwEEWvk9AB6cB0AB1AB7iDpAPowO4AOggd2B3gDrgOuOf98loosknm+KPRSCv5fa1kC/5Ug/YvVYBWVTBIov+pmNYbqP/XdL/f44bXb4vibVlQ0/6JxBwNqA2bEbOL1aanq5iH4qqzcmzGgGGvJUerEaKRjPmgOYNEbds6Wo3dvuwbi2K92R2O1Wq9u3bd5XKBuy8/f2fA1BidaXvXLFfr7e8M9FiMY9XEv74uI9fin4cjcdHRjw0cPeCW76uxawV0XZ+AhmfMJmPQdd3tdlMdJiqDAZQpNoqlJsujX/+UQSLmxaCkPh5r4cqPw+l8NougSQPPQPWZjXaiFRZLkOdFEQ69Fxv6oWPKGyTinXO0bPoTfgRJbubeTwyURIxWaa+88Z1Y83pigJg0ood911D8FriSJCYNtHYp0OOyKHyCcFOaNIgV7rhh+fJYLFfyCKRIfgDUGQPunKttsUvEsUQbld2lWHkD9+B5vk8nsurR5pnHkwxkg2IouKZphabe7koiSESXnzPKG0iy8eXLAPU5DZZcdpbDZBJzBqiqT87abEtAGFD3kcGYq4JgQA7yJOYMyIDfEAfZ6kfJVUNTGaA5AxTodvkkrxbyUXUD8lEZA37zEjoNLnoFxZJ8VFsXkCZtUf4MMGiaZqRb0YEnSfgorKldyhhA59z8YZy4hLV8JA8tufywW3bialISGQMy8I+La5m/DiA9A9mISFfT6tNZEaFj5Q18i2gYcPzuULxRfQbLglS+HwPKnAHCANHlHR0MgpIMkNZBzQ9c9hjEDAbI+y9RTAsGSNFXKUCr6h/AoMU7QRkg5AAAAABJRU5ErkJggg==" 
width="30px" height="30px" align="middle" value = "Test Button" onclick="Load_Preset()"/> <Br><Br>

       ---------------------------  -->

<!-- <table class="table table-striped table-hover" id="PluginsTable"> -->
<!-- <table class="table table-hover" id="PluginsTable">     declaration for  jQuery.FilterTable 
<!-- <table class="table table-striped table-bordered" id="PluginsTable"  > -->


<!-- <a href="#" class="btn btn-default btn-sm" value="NewPreset" onclick="ClearFilters()">ClearFilters</a>  -->

<table class="table table-hover" id="PluginsTable"> 
 <thead>
  <tr class="warning">
    <th>#</th>
    <th>Name</th>
    <th>mod</th>
	<th>Category</th>
	<th>Description</th>
	<th>Preview</th>
	<th>State</th>
  </tr>
</thead> 

  


<tbody>
<!--
      <tr class="warning" id="filterRow">
        
        <td></td>
        <td><input type="text" id="NameInputFilter" onkeyup="FilterTable()" placeholder="Search for names.." title="Type in a name"></td>
        <td></td>
        <td></td>
		<td></td>
		<td></td>
		<th><input type="checkbox">Filter enabled</th>
      </tr> 
-->

<script language="VBScript" src="dependencies\iniwrite.vbs"></script>   <!-- Library to read and write ini filres -->

<script type="text/vbs">

Dim FSO
Set FSO = CreateObject("Scripting.FileSystemObject")
if not FSO.FolderExists(".\Plugins") then FSO.CreateFolder(".\Plugins") ' We check if the folder exist...
ShowSubfolders FSO.GetFolder(".\Plugins"), 1     'here we can indicate the depth of subfolders we want
set FSO = Nothing


'  recursive function to scan all sub directory in "Plugins" folder
Sub ShowSubFolders(Folder, Depth)    
	Dim files, item
	Dim StrData
	Dim PresetsPath
	Dim DropDown

    If Depth > 0 then
		
        For Each Subfolder in Folder.SubFolders
            'Wscript.Echo Subfolder.Path
			StrData = ""
			SmaFileName = ""
			AmxxFileName = ""
			PluginOtherFiles = ""
			CurPluginNumber = CurPluginNumber + 1

			PluginFilesPath = FSO.BuildPath(Subfolder.Path, "\files")
			If Not FSO.FolderExists(PluginFilesPath) Then FSO.CreateFolder(PluginFilesPath) ' We check if the folder exist...
			Set Pluginfolder = fso.GetFolder(PluginFilesPath)
			
			document.write "<tr class=""table-secondary""><td>" & CurPluginNumber & "</td>"
			document.write "<td><div style='display:inline;'  id='Name_"& CurPluginNumber &"'>" & Subfolder.name & "</div>"  ' <<<<<<<<<------------------  Here we write the number and the name of the plugin (based on folder name) , display:inline important to have the folder icon on the same line
			'document.write " <input type='IMAGE' <img alt='Test Button' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAACASURBVDhPxZPRCYAwDES7goO4caE4g/P0o51Ec6T0KNWkIPjggVxy8UMMn1BKSbcneejIx1CGOvIxO/BkrTVqrTNbfFNrHRpuGq3Bl+mYZUJZaCE/e0RZ4IAXLFEWOOAFS5QFDnjBEmWhBTnnnRcstb72VlbrODD+Cx77Z/yREC7ODt7GVk9G6wAAAABJRU5ErkJggg==' align='right' value='Test Button' onclick='Load_Preset()'/></div> <br><ul class='list-group'>"
			
			document.write "<a href='file:///" & Subfolder.Path & "' style='float:right;'><img border='0' alt='Folder' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuM4zml1AAAACASURBVDhPxZPRCYAwDES7goO4caE4g/P0o51Ec6T0KNWkIPjggVxy8UMMn1BKSbcneejIx1CGOvIxO/BkrTVqrTNbfFNrHRpuGq3Bl+mYZUJZaCE/e0RZ4IAXLFEWOOAFS5QFDnjBEmWhBTnnnRcstb72VlbrODD+Cx77Z/yREC7ODt7GVk9G6wAAAABJRU5ErkJggg=='></a>"
			document.write "<br><br><ul class='list-group' ondblclick='OpenFilesFolder(" & CurPluginNumber & ")'>"




				Set Pluginfiles = Pluginfolder.Files
				' Loop through each file  

				
				For Each item In Pluginfiles
					if right(item.Name,4) = ".sma" then 
						SmaFileName = item.Name
						SmaFilePath = item.path
						'Continue For    ' immediately to the next iteration of the loop.
					elseif right(item.Name,5) = ".amxx" then 
						AmxxFileName = item.Name
						'Continue For
					else
						PluginOtherFiles = PluginOtherFiles & item.Name & "&#10;"   '  &#10; = cariage return for tooltip
					end if
				Next
				
			if SmaFileName <> "" then
				document.write "<span data-toggle='tooltip' data-placement='left' title='Hooray!&#10;yeah'>"
				document.write "<li class='list-group-item'><span id='sma_"& CurPluginNumber &"'>" & SmaFileName & "</span><div class='pull-right'><span class='label label-success' onclick='Mymsgbox(" & CurPluginNumber & ")'>ok</span></div></li></span>"
			else
				document.write "<li class='list-group-item'><span id='sma_"& CurPluginNumber &"'>sma file</span><div class='pull-right'><span class='label label-danger' onclick='Mymsgbox(" & CurPluginNumber & ")'>no</span></div></li>"
			end if
			
			
			if AmxxFileName <> "" then
				document.write "<li class='list-group-item'><span id='amxx_"& CurPluginNumber &"'>" & AmxxFileName & "</span><div class='pull-right'><span class='label label-success'>ok</span></div></li>"
			else
				if SmaFileName <> "" then 
					' if there's already a sma file, we know the futur name of the amxx file...
					document.write  "<li class='list-group-item'><span id='amxx_"& CurPluginNumber &"'>" & replace(SmaFileName,".sma",".amxx") & "</span><div class='pull-right'><span id='LblAmxx_" & CurPluginNumber & "' class='label label-danger' style='cursor:pointer' onclick='CompileSma(" & CurPluginNumber & ")'>no</span></div></li>"  
				else
					document.write  "<li class='list-group-item'><span id='amxx_"& CurPluginNumber &"'>amxx file</span><div class='pull-right'><span class='label label-danger text-right' onclick='CompileSma(" & CurPluginNumber & ")'>no</span></div></li>"
				end if
			end if
			'document.write "<td  id='Name_"& CurPluginNumber &"'>" & Subfolder.name & "</td>"

			if PluginOtherFiles <> "" then
				document.write "<span data-toggle='tooltip' data-placement='left' title='"& PluginOtherFiles & "'><li class='list-group-item'><span id='Files_"& CurPluginNumber &"'>additional files</span><div class='pull-right'><span class='label label-success' onclick='Mymsgbox(" & CurPluginNumber & ")'>ok</span></div></li></span>"
			else
				'document.write "<li class='list-group-item'>additional files<div class='pull-right'><span class='label label-danger' onclick='Mymsgbox(" & CurPluginNumber & ")'>no</span></div></li>"
			end if
			
			' ============================  Description  ============================
			filepath = FSO.BuildPath(Subfolder.Path, "description.ini")
			If FSO.FileExists(filepath) Then    ' Description file is the minimum to show a subfolder in the GUI
			
			
					Dim ini
					Set ini = New IniFile
					Call ini.Load(filepath,1)
					' test to include url directly in the name -> prefer to put it in description
					'document.write "<tr class=""table-secondary""><td>" & CurPluginNumber & "</td><td><a href='" &  ini.GetKeyValue("Details","url") & "'>" & Subfolder.name & "</a></td>"   ' <<<<<<<<<------------------  Here we write the number and the name of the plugin (based on folder name)
					document.write "</ul></td><td>" &  ini.GetKeyValue("Details","Category") & "</td>"
					document.write "<td>" &  ini.GetKeyValue("Details","Mod") & "</td>"

					Plugin_URL = ini.GetKeyValue("Details","url")
					if Plugin_URL <> "" then
						document.write "<td>" &  ini.GetKeyValue("Details","Description") & "<br><a class='text-info' id='url_"& CurPluginNumber &"' href='" &  Plugin_URL & "' target='_blank'>Source</a>"
					else
						Plugin_URL = "https://www.amxmodx.org/compiler.php?mod=1&cat=0&plugin=" & replace(Subfolder.name," ", "+") & "&author=&go=search"
						document.write "<td>" &  ini.GetKeyValue("Details","Description") & "<br><a class='text-danger' id='url_"& CurPluginNumber &"' href='" &  Plugin_URL & "' target='_blank'>Source is missing</a>"
					end if
					if FSO.FileExists("Plugins/"& Subfolder.name & "/backup.html") then
						document.write " - <a class='text-info' href='Plugins/"& Subfolder.name & "/backup.html' target='_blank'>Backup</a></td>"
					else
						'document.write " - <a class='text-info' id='bck_" & CurPluginNumber & "' onclick='GenerateBackup(" & CurPluginNumber & ")'>Backuuuuup</a></td>"
						'document.write " - <span class='text-danger' id='bck_"& CurPluginNumber &"' style='cursor:pointer' data-url='" &  ini.GetKeyValue("Details","url") & "' onclick='GenerateBackup(" & CurPluginNumber & ")'>Backup is missing</span></td>"
						document.write " - <a class='text-danger' id='bck_"& CurPluginNumber &"' style='cursor:pointer' onclick='GenerateBackup(" & CurPluginNumber & ")'>Backup is missing</span></td>"
					end if
					set ini = nothing
					
				'======= old way : we don't read an ini file but a full txt file (which can contains html)
				' Set File = fso.OpenTextFile(filepath)
				' Do until File.atendofstream
					' StrData = StrData & "<Br>" & trim(File.ReadLine)
				' Loop
				' File.close
				' document.write "<td>" & StrData & "</td>"       ' <<<<<<<<<------------------  Here we write the description
			Else
				
				document.write "<td> No Description</td>"
				document.write "<td> No Description</td>"
				document.write "<td> No Description</td>"
				'Wscript.Echo "File does not exist."    ' Here we log that a subfolder exist without description
			End If
			' ============================  Preview File  ============================

			
			filepath = FSO.BuildPath(Subfolder.Path, "Preview.jpg")
			If FSO.FileExists(filepath) Then
				document.write "<td><img height='200' width='250' src=""" & filepath & """><div class='invisible'>jpg</div></td>"
			Else
				filepath = FSO.BuildPath(Subfolder.Path, "Preview.png")
				If FSO.FileExists(filepath) Then
					document.write "<td><img height='200' width='250' src=""" & filepath & """><div class='invisible'>png</div></td>"
				Else
					filepath = FSO.BuildPath(Subfolder.Path, "Preview.gif")
					If FSO.FileExists(filepath) Then
						document.write "<td><img data-gifffer-height='200' data-gifffer-width='250' data-gifffer=""" & filepath & """><div class='invisible'>gif</div></td>"
					Else
						filepath = FSO.BuildPath(Subfolder.Path, "Preview.mp4")
						If FSO.FileExists(filepath) Then
							'<!-- video-js Support (better player than the default integrated in IE/hta-->
							document.write "<td><video id='my-video' class='video-js'  controls  preload='auto'  width='250'  height='200'  data-setup='{}' ><source src=""" & filepath & """ type='video/mp4' />mp4</video></td>"  ' "mp4" is used for filter
							'<!-- Default hta player-->
							'document.write "<td><video width='250' height='200' controls>  <source src=""" & filepath & """ type='video/mp4'>Your browser does not support the video tag.</video></td>"
							'document.write "<td><embed src=""" & filepath & """ width=""250"" height=""200"" autostart=""false"" type=""video/mp4""></td>"
							'document.write "<td><iframe src='https://player.vimeo.com/video/298038460?loop=1&byline=0&portrait=0&title=0&transparent=0' allowtransparency></iframe></td>"
							'document.write "<td><iframe width='320' height='240	' src='https://www.youtube.com/embed/YGPm77kDddg' frameborder='0' allow='autoplay; encrypted-media; picture-in-picture' allowfullscreen></iframe></td>"
						Else
							document.write "<td> No Preview</td>"
							'Wscript.Echo "File does not exist."    ' Here we log that a subfolder exist without any Preview
						End If
					End If
				End If
			End If
			
			document.write "<td><input type=""checkbox"" id='chk_"& CurPluginNumber &"' onchange='PresetModified()'></td></tr>"   ' <<<<<<<<<------------------  Here we write the actions column
            '<button type=""button"" class=""btn btn-success"">Add</button><button type=""button"" class=""btn btn-danger"">Remove</button>   '   ==== old useless buttons
			ShowSubFolders Subfolder, Depth -1    'recursive call
        Next
    End if

End Sub

</script>

<!--   This Tfoot will be transformed into search box thanks to search boxes -->
	
</tbody>
        <tfoot>
            <tr>
                <td></td>
                <th></th>
                <th></th>
                <th></th>
                <th></th>
				<th></th>
				<td></td>
            </tr>
        </tfoot>
</table>


<!--   Other tabs for futu use -->
</div>
  <div class="tab-pane fade" id="settings">
	  <br><h1>In progress...</h1>
  </div>
  <div class="tab-pane fade" id="dropdown1">
    <br><h1>In progress...</h1>
  </div>
  <div class="tab-pane fade" id="dropdown2">
    <br><h1>In progress...</h1><br><a href=https://github.com/schmurtzm/AMXX-Browser/projects/1?fullscreen=true>Follow Project</a> 
  </div>
</div>

<script>
		//  ==================================== GIFFER (pause on .gif file) ====================================
window.onload = function() {
    Gifffer();
}

		//  ==================================== basic function to allow to filter on checkbox state ====================================
/*
$(document).ready(function() {
     $("#filterRow input[type=checkbox]").click(function(){
     if($(this).is(":checked"))
     {
       $("input[type=checkbox]").each(function() {
       if($(this).is(":checked"))
        $(this).parent().parent().show();
       else
        $(this).parent().parent().hide();
       });

     }
     else
     {
       $("input[type=checkbox]").parent().parent().show();
     }
    });
});
*/

</script>

<!--  ==================================== Basic autonomous little function to filter a table (test 1/3) ==================================== -->

<!-- function FilterTable() {
var input, filter, table, tr, td, i, txtValue;
input = document.getElementById("NameInputFilter");
filter = input.value.toUpperCase();
table = document.getElementById("PluginsTable");
tr = table.getElementsByTagName("tr");
for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1]; // here you can choose which column to filter
    if (td) {
        txtValue = td.textContent || td.innerText;
        if (txtValue.toUpperCase().indexOf(filter) > -1) {
            tr[i].style.display = "";
        } else {
            tr[i].style.display = "none";
        }
    }
}
} -->

<!--  ==================================== declaration for the library "jQuery.FilterTable" (test 2/3) ==================================== -->
  <!--  jQuery.FilterTable initialisation function  -->
<!--
<script >
    $(document).ready(function() {
        // apply filterTable to all tables on this page
        $('table').filterTable({
            filterExpression: 'filterTableFindAny'
        });
    }); 
	
</script>

-- >

<!--  ==================================== declaration for the library "datatables" (test 3/3) ==================================== -->
<script>
    $(document).ready(function() {
        // Setup - add a text input to each footer cell
        $('#PluginsTable tfoot th').each(function() {
            var title = $(this).text();
            $(this).html('<input type="text" id="myInputFilter" class="form-control input-sm search-box" placeholder="Search ' + title + '" />');
        });

        // DataTable
        var table = $('#PluginsTable').DataTable({
            'pageLength': 50, // where you choose the default number of row displayed
            /*   dom: 'Blfrtip',
					buttons: [    // here you can display button to export table data
					'copy', 'csv', 'excel', 'pdf', 'print'
					],
			*/
            "initComplete": function() {
                // Apply the search
                //this.api().columns().every( function () {     // If you want to only show certain columns you can use a array, see below : 
                this.api().columns([1, 4]).every(function() {
                    var that = this;

                    $('#PluginsTable tfoot tr').appendTo('#PluginsTable thead'); // To displays the search boxs at the top instead to the bottom of the table
                    $('input', this.footer()).on('keyup change clear', function() {
                        if (that.search() !== this.value) {
                            that
                                .search(this.value)
                                .draw();
                        }
                    });
                });


                // -------------- here we add dropdown selectors filters to specified columns  --------------
                this.api().columns([2, 3]).every(function() {
                    var column = this;
                    var select = $('<select class="form-control input-sm search-box"><option  value=""></option></select>')
                        .appendTo($(column.footer()).empty())
                        .on('change', function() {
                            var val = $.fn.dataTable.util.escapeRegex(
                                $(this).val()
                            );

                            column
                                .search(val ? '^' + val + '$' : '', true, false)
                                .draw();
                        });

                    column.data().unique().sort().each(function(d, j) {
                        select.append('<option value="' + d + '">' + d + '</option>');
                    });
                });


                // -------------- here we add dropdown selectors specific for preview files  --------------
                this.api().columns([5]).every(function() {
                    var column = this;
                    var select = $('<select class="form-control input-sm search-box"><option  value=""></option></select>')
                        .appendTo($(column.footer()).empty())
                        .on('change', function() {
                            var val = $.fn.dataTable.util.escapeRegex(
                                $(this).val()
                            );

                            column
                                .search(this.value)
                                .draw();
                        });

                    {
                        select.append('<option value="jpg">jpg</option>');
                        select.append('<option value="png">png</option>');
                        select.append('<option value="gif">gif</option>');
                        select.append('<option value="mp4">mp4</option>');
                        select.append('<option value="no preview">no preview</option>');
                    }
                });

                // -------------- here we add checkbox state   --------------

                this.api().columns([6]).every(function() {
                    var column = this;
                    var select = $('<input type="checkbox" id="chk_MainFilter">')
                        .appendTo($(column.footer()).empty())
                        .on('change', function() {
                            table.draw();
                            /*
                              var ischecked = $(this).is(':checked');
                              if (ischecked) {
                                  // If selected records should be displayed
                                  $.fn.dataTable.ext.search.pop();
                                  $.fn.dataTable.ext.search.push(
                                      function (settings, data, dataIndex) {
                                          var row = table.row(dataIndex).node();
                                          var checked = $('#chk_' + dataIndex).prop('checked');
                                          var currentCheckChecked = $(row).find('input').prop('checked');
                                          if (currentCheckChecked ) { 
                                              return true;
                                          }

                                          return false;
                                      }
                                  );

                                  table.draw();

                              } else {
                                  $.fn.dataTable.ext.search.pop();
                                  $.fn.dataTable.ext.search.push(
                                      function (settings, data, dataIndex) {
                                          var row = table.row(dataIndex).node();
                                          var checked = $('#chk_' + dataIndex).prop('checked');
                                          var currentCheckChecked = $(row).find('input').prop('checked');
                                          if (currentCheckChecked ) {  
                                              return true;
                                          }

                                          return true;
                                      }
                                  );

                                  table.draw();
                              }
                              */
                        });


                });




                // Checkvbox filter
                $.fn.dataTable.ext.search.push(
                    function(settings, data, dataIndex) {

                        var filter_checked = $('#chk_MainFilter').prop('checked');

                        // Show checked rows if filter is checked.
                        if (filter_checked) {
                            var row = table.row(dataIndex).node();
                            var checked = $('#chk_' + dataIndex).prop('checked');
                            var currentCheckChecked = $(row).find('input').prop('checked');
                            if (currentCheckChecked) {
                                return true;
                            }

                            return false;
                            // Otherwise show all rows.
                        } else {
                            return true;
                        }
                    }
				);
				


				



            },
            "lengthMenu": [ [5, 25, 50, -1], [5, 25, 50, "All"] ] //Page length options , cf. https://datatables.net/examples/advanced_init/length_menu
		});
		

		

		new $.fn.dataTable.Buttons( table, {
			buttons: [
				{
					text: 'Clear Filters',
					action: function () {
						$('.search-box').val('');  // Clear ext and select inputs with classname search-box
						$('#chk_MainFilter').prop('checked', false).change();  // Clear checkbox and trigger change event
						var table = $('#PluginsTable').DataTable();
						table
						.search( '' )
						.columns().search( '' )
						.draw();
					}
				}
			]
		} );
	 
		table.buttons( 0, null ).container().prependTo(
			table.table().container()
		);



    });




function check() {
    //document.getElementById("chk_MainFilter").checked = true;
    document.getElementById('chk_MainFilter').click();
}

function ClearFilters() {
	
	$('.search-box').val('');  // Clear ext and select inputs with classname search-box
	$('#chk_MainFilter').prop('checked', false).change();  // Clear checkbox and trigger change event
  
  
	  var table = $('#PluginsTable').DataTable();
	  table
	  .search( '' )
	  .columns().search( '' )
	  .draw();
}



/*
$(document).ready(function() {
    $('#PluginsTable').DataTable( {
        initComplete: function () {
            this.api().columns().every( function () {
                var column = this;
                var select = $('<select><option value=""></option></select>')
                    .appendTo( $(column.footer()).empty() )
                    .on( 'change', function () {
                        var val = $.fn.dataTable.util.escapeRegex(
                            $(this).val()
                        );
 
                        column
                            .search( val ? '^'+val+'$' : '', true, false )
                            .draw();
                    } );
 
                column.data().unique().sort().each( function ( d, j ) {
                    select.append( '<option value="'+d+'">'+d+'</option>' )
                } );
            } );
        }
    } );
} );
*/
  </script>
  
 


<SCRIPT language="VBScript">


Sub Load_Preset
	if ModificationIndic.classname = ""	 then 
		Question =  MsgBox("The preset """ & PreviousPreset & ".ini"" has been modified" &_
					VbCrLf & "Do you want to save it ?",_
					vbyesnocancel + vbExclamation , "Previous preset modified")

		Select Case Question
		Case VbYes
			Save_Preset PreviousPreset,false
		Case VbNo
			' Nothing to do before continue loading
			ModificationIndic.classname = "invisible"
		Case VbCancel
			FillPresetsList(PreviousPreset)   ' we set the previous selected preset
			exit sub
		End Select
	end if
	
	
	ClearFilters()  ' we clear all filters before loading a new preset
	Set FSO = CreateObject("Scripting.FileSystemObject")
	'msgbox Name_3.parentElement.tagname
	filepath = FSO.BuildPath(".\presets\",  SelectPreset.value)
	
	If FSO.FileExists(filepath) Then
		'If document.GetElementById("chk_MainFilter").checked Then document.GetElementById("chk_MainFilter").click    ' done in ClearFilters function now
		' we reinitialize all the checkboxs
		For i = 1 To CurPluginNumber
			document.GetElementById("chk_" & i).checked = False
		Next
		
		Set File = fso.OpenTextFile(filepath)
		Do Until File.atendofstream
			
			' we suppress tabs and spaces to the CurrentLine
			CurrentLine = Replace(File.ReadLine, " ", "")
			CurrentLine = Replace(CurrentLine, vbTab, "")
			If Not Left(CurrentLine,1) = ";" Then 'this line is not a comment
				If InStr(CurrentLine,";") > 0 Then  ' if there is a comment at the end of the line we suppress it
					CurrentLine =  Left(CurrentLine, InStr(CurrentLine, ";") - 1)
				End If 
				
				For i = 1 To CurPluginNumber
					'msgbox "current row : " & document.GetElementById("Name_" & i).innerHtml
					'msgbox "current line : " & CurrentLine
					If document.GetElementById("amxx_" & i).innerText =  CurrentLine Then
						'msgbox "found !"
						
						document.GetElementById("chk_" & i).checked = True				
					End If
				Next
			End If
		Loop
		File.close
		If Not document.GetElementById("chk_MainFilter").checked Then document.GetElementById("chk_MainFilter").click  'we apply a filter to show only selected plugins
	else
		'If document.GetElementById("chk_MainFilter")If document.GetElementById("chk_MainFilter").checked Then document.GetElementById("chk_MainFilter").click
		'For i = 1 To CurPluginNumber
		'	document.GetElementById("chk_" & i).checked = False
		'Next
		msgbox "The preset " & SelectPreset.value & "doesn't exist."
	End If
	
	'msgbox document.GetElementById("chk_MainFilter").name
	'msgbox document.getElementsByName("chk_MainFilter").item(0).name
End Sub





Sub New_Preset()
	Dim sInput
	sInput = InputBox("Enter a preset name")
	if sInput <> "" then
		Save_Preset sInput,true
		'FillPresetsList(sInput)  ' we reload the dropdwon list of presets
	else
		msgbox "You must enter a name"
	end if
end sub




Sub Save_Preset(PresetFileName,IsNewFile)
	Dim ReadyToSave
	ReadyToSave = false
	Dim WasChecked
	WasChecked = false
	Const SourceFile = "presets\.Template.ini"
	Dim objShell
	Dim strCmd
	set objShell = CreateObject("wscript.Shell")
	Set FSO = CreateObject("Scripting.FileSystemObject")
	Dim ini

	If document.GetElementById("chk_MainFilter").checked Then  'we desactivate the filters
		' document.GetElementById("chk_MainFilter").click   'now done in ClearFilters()
		WasChecked = true
	end if
	ClearFilters()
	


	if PresetFileName = "?"  Then
		if SelectPreset.value = "" then 
			msgbox "Select an existing preset or create a new one before saving."
			exit sub
		else
			NewPresetName = SelectPreset.value
		end if
	else
		NewPresetName = PresetFileName
	end if

	subSleep(1)

	if right(NewPresetName,4) = ".ini" then NewPresetName = Left(NewPresetName, Len(NewPresetName)-4) 'if .ini has been written, we remove it
	DestinationFile = ".\presets\" & NewPresetName & ".ini"


	Set fso = CreateObject("Scripting.FileSystemObject")
		'Check to see if the file already exists in the destination folder
		If fso.FileExists(SourceFile) Then
			If fso.FileExists(DestinationFile) Then
				if IsNewFile = true then   ' if it is a new file but it already exist
					If MsgBox("The preset """ & NewPresetName & ".ini"" already exist" & chr(13) & "Do you want to overwrite it ?", vbYesNo + vbExclamation , "File already exists") = vbYes Then 
						ReadyToSave = true 'Replace the file
					End If
				else
					ReadyToSave = true
				end if
			Else
				'The file does not exist in the destination folder.  Safe to copy file to this folder.
				ReadyToSave = true
				
			End If
		else
			msgbox "The file ""Presets\.Template.ini"" is missing !" & chr(13) & chr(13) &_
			"You probably delete it, get it from ""Amxx Bbrower"" archive or from AMXX default setup." & chr(13) & chr(13) &_
			"Your file will only contains selected plugins (default amxx plugins will miss : it's not recommanded)."
		end if
		
		
		if ReadyToSave then
			fso.CopyFile SourceFile, DestinationFile, True
			Set objFile = fso.OpenTextFile(DestinationFile,8,true) 'open file to append
			For i = 1 To CurPluginNumber
				If document.GetElementById("chk_" & i).checked  Then
					PluginRootPath = fso.GetFolder( ".\Plugins\" &  document.GetElementById("Name_" & i).innerText)
					PluginFilesPath = fso.GetFolder( ".\Plugins\" &  document.GetElementById("Name_" & i).innerText & "\Files\")
					AmxxFilename =  document.GetElementById("amxx_" & i).innerText
					FullAmxxPath =  PluginFilesPath & "\" &  AmxxFilename
					PluginName = document.GetElementById("Name_" & i).innerText
					SmaFilename =  document.GetElementById("sma_" & i).innerText
					FullSmaPath =  PluginFilesPath & "\" &  SmaFilename

					if (FSO.FileExists(FullAmxxPath) = false and FSO.FileExists(FullSmaPath) = false) then     ' if necessary files are not here
						msgbox "Amxx and sma files are missing." & chr(13) & """" & PluginName & """ will not be included in this preset.",vbcritical , PluginName & " - Missing Files"
					else
						if (FSO.FileExists(FullAmxxPath) = false and FSO.FileExists(FullSmaPath) = true) then  ' if the sma file exist and not the amxx file, we try to compile the sma
							CompileSma(i)
						end if

						If FSO.FileExists(FullAmxxPath) Then  ' now if hte amxx file exist we add the line in the config file
							' ************************** section to write description **************************
							if Chk_IncDesc.checked then
								inipath = FSO.BuildPath(PluginRootPath, "description.ini")
								If FSO.FileExists(inipath) Then
									Set ini = New IniFile
									Call ini.Load(inipath,1)
									objFile.Write "; " & ini.GetKeyValue("Details","ShortDescription")  & vbCrLf
								end if
							end if
							' *********************************************************************************
							objFile.Write document.GetElementById("amxx_" & i).innerText & vbCrLf		
						else
							msgbox "Amxx file " & AmxxFilename & "is missing." & chr(13) & PluginName & " will not be included.", vbcritical
						end if
					end if
				End If
			Next


			objFile.Close
			Set objFile = Nothing
			Set fso = Nothing

			If WasChecked = true Then ' if the filter was previously here, we apply it again
				document.GetElementById("chk_MainFilter").click
			end if

			if IsNewFile then
				FillPresetsList(NewPresetName & ".ini") ' we reload the dropdwon list of presets
			end if

			
			' we display that the save has been done
			ModificationIndic.classname = "invisible"
			document.getElementById("BtnPresetSave").innerHTML="saved"
			document.getElementById("BtnPresetSave").classname = "btn btn-success btn-sm"
			subSleep(2)
			document.getElementById("BtnPresetSave").innerHTML="Save"
			document.getElementById("BtnPresetSave").classname = "btn btn-default btn-sm"
			
		end if
		
End Sub

Sub subSleep(strSeconds) ' useful to avoid hanging... example of use : subSleep(2)
    Dim objShell
    Dim strCmd
    set objShell = CreateObject("wscript.Shell")
    'objShell.Run cmdline,1,False

    strCmd = "%COMSPEC% /c ping -n " & strSeconds & " 127.0.0.1>nul"     
    objShell.Run strCmd,0,1 
End Sub 


Sub Mymsgbox(Myparam) ' useful to avoid hanging... example of use : subSleep(2)
	msgbox Myparam
End Sub 


Sub CompileSma(PluginNumber) 
' TODO : add a lot of check for the different paths

    Dim objShell
    Dim strCmd
	set objShell = CreateObject("wscript.Shell")
	Set FSO = CreateObject("Scripting.FileSystemObject")
	
	' Get the current version number of amxx :
	'msgbox FSO.GetFileVersion(".\Tools\AMX Mod X\files\base\dlls\amxmodx_mm.dll")
	
	Set CompilatorPath = fso.GetFile( ".\Tools\AMX Mod X\files\base\scripting\amxxpc.exe")
	'msgbox CompilatorPath
	
	PluginFilesPath = fso.GetFolder( ".\Plugins\" &  document.GetElementById("Name_" & PluginNumber).innerText & "\Files\")
	'msgbox PluginFilesPath
	
	'Set FullSmaPath = fso.GetFile( ".\Plugins\" &  document.GetElementById("Name_" & PluginNumber).innerText & "\Files\" & document.GetElementById("sma_" & PluginNumber).innerText)
	SmaFilename =  document.GetElementById("sma_" & PluginNumber).innerText
	FullSmaPath =  PluginFilesPath & "\" &  SmaFilename

	
	If MsgBox("Do you want compile """ & SmaFilename & """ with amxx v" & FSO.GetFileVersion(".\Tools\AMX Mod X\files\base\dlls\amxmodx_mm.dll") & " now ?", vbYesNo + vbQuestion , "Generate amxx file ?") = vbYes Then 
		strCmd = "%COMSPEC% /c title Compilation & cd /d " & PluginFilesPath & " & """ & CompilatorPath & """ " & document.GetElementById("sma_" & PluginNumber).innerText & " &echo.&Pause"
		objShell.Run strCmd,,1       ' ,0,1 = run not hidden , wait for the end to continue
	End If

	' After compilation, we check if the amxx file exist
	If FSO.FileExists(PluginFilesPath & "\" & Left(SmaFilename, Len(SmaFilename)-4) & ".amxx") Then
		document.GetElementById("LblAmxx_" & PluginNumber).innerText = "ok"
		document.GetElementById("LblAmxx_" & PluginNumber).classname = "label label-success"  ' we change the color of the little label to green
	else
		msgbox "Amxx file is not here." & chr(13) & "There was probably a compilation error...", vbcritical
	end if


	exit sub
	' bad because it's changing the global currrent path
	'objShell.CurrentDirectory = ".\Plugins\" &  document.GetElementById("Name_" & PluginNumber).innerText & "\Files\"
	

End Sub 





Sub OpenFilesFolder(PluginNumber) 
' TODO : add a lot of check for the different paths
    Dim objShell
    Dim strCmd
	set objShell = CreateObject("wscript.Shell")
	Set FSO = CreateObject("Scripting.FileSystemObject")
		
	PluginFilesPath = fso.GetFolder( ".\Plugins\" &  document.GetElementById("Name_" & PluginNumber).innerText & "\Files\")

	objShell.Run "explorer """ & PluginFilesPath & ""       ' ,0,1 = run not hidden , wait for the end to continue

End Sub 



Sub OpenPreset()
    Dim objShell
	set objShell = CreateObject("wscript.Shell")
	DestinationFile = ".\presets\" & SelectPreset.value
	objShell.Run DestinationFile      ' ,0,1 = run not hidden , wait for the end to continue
	Set objShell = Nothing
End Sub 

Sub PresetModified()
	ModificationIndic.classname = ""
End Sub 

Sub SetPreviousPreset()
	PreviousPreset = SelectPreset.value
End Sub 


Sub GenerateBackup(PluginNumber) 
' TODO : add a lot of check for the different paths
    Dim objShell
    Dim strCmd
	set objShell = CreateObject("wscript.Shell")
	Set FSO = CreateObject("Scripting.FileSystemObject")


	Set monolithPath = fso.GetFile( ".\Tools\monolith\monolith.exe")
	PluginFilesPath = fso.GetFolder( ".\Plugins\" &  document.GetElementById("Name_" & PluginNumber).innerText)
	SourceURL = document.GetElementById("url_" & PluginNumber).href

	If MsgBox("Do you want to make a backup of this source url ?" & vbCrLf & SourceURL, vbYesNo + vbExclamation , "Create backup ?") = vbYes Then 
		objShell.Run monolithPath & " " & SourceURL & " -o """ & PluginFilesPath & "\backup.html""",1,1 ' = run not hidden , wait for the end to continue

		if FSO.FileExists(PluginFilesPath & "\backup.html") then
			Set Mybackup = document.GetElementById("bck_" & PluginNumber)
			Mybackup.href = PluginFilesPath & "\backup.html" ' after modification of the href, the backup will be automatically opened
			Mybackup.innerText = "New Backup"                ' just to identify fresh backups
			Mybackup.onclick = ""
			Mybackup.classname = "text-info"
		else
			msgbox "There was probably a problem during the making of the web page backup" , vbcritical , "Backup file is missing"
		end if

	End If


	set objShell = Nothing
	Set FSO = Nothing
End Sub 



</SCRIPT>

</body></html>